<!--
  @description       : html to output vertical tabs based on metadata configuration
  @author            : daniel@hyphen8.com
  @last modified on  : 12-09-2025
  @last modified by  : daniel@hyphen8.com
-->
<template>
    
    <template if:true={isLoading}>
        <div class="slds-align_absolute-center slds-is-relative" style="height:5rem">
            <lightning-spinner
                alternative-text={label.loadingAltText} variant="brand">
            </lightning-spinner>
        </div>
    </template>
    <template if:false={isLoading}>
        <div class="slds-vertical-tabs tabsCustom">
            <ul class="slds-vertical-tabs__nav navCustom" data-id="hostWrapper" role="tablist" aria-orientation="vertical">
                <template for:each={sections} for:item="section">
                    <c-h8-flow-form-render-item key={section.id} section={section} active-section={activeSectionId} onsectionselected={handleChangeSection}></c-h8-flow-form-render-item>
                </template>
            </ul>
            <div class="slds-vertical-tabs__content slds-show" id={activeSectionId} role="tabpanel" aria-labelledby={activeSectionId}>
                <div class="slds-text-longform slds-is-relative">
                    <template if:true={loadFlow}>
                        <div class="slds-align_absolute-center" style="height:5rem">
                            <lightning-spinner
                                alternative-text={label.loadingAltText} variant="brand">
                            </lightning-spinner>
                        </div>
                    </template>
                    <template if:false={loadFlow}>
                        <template if:true={renderValidationPanel}>
                            <c-h8-section-validation-panel section-label={activeSectionLabel}
                                                            affect-text-label={label.affectedQuestionsText}
                                                            help-text={label.generalHelpText}
                                                            default-open="true"
                                                            auto-collapse-on-fix
                                                            live-has-errors={activeLiveHasErrors}
                                                            live-pages={activeLivePages}
                                                            master-has-errors={activeMasterHasErrors}
                                                            master-pages={activeMasterPages}>
                            </c-h8-section-validation-panel>
                        </template>

                        <div class="flow-wrapper" data-id="flowWrapper">
                            <lightning-flow flow-api-name={flowAPIName} 
                                            flow-input-variables={inputVariables}
                                            onstatuschange={handleStatusChange}>
                            </lightning-flow>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </template>
</template>
